<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>दैनंदिन रिकवरी रेकॉर्ड</title>
  <style>
    /* --- तुमचा मूळ CSS जसा आहे तसाच --- */
    :root {
      --brand-blue: #007AFF; --brand-blue-hover: #0056b3; --brand-green: #34C759;
      --brand-green-hover: #2ca048; --brand-red: #FF3B30; --bg-color: #f0f2f5;
      --card-bg-color: #ffffff; --text-primary: #1c1c1e; --text-secondary: #636366;
      --border-color: #d1d1d6; --input-bg: #f7f7f7; --border-radius-s: 6px;
      --border-radius-m: 10px; --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
      --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    *, *::before, *::after { box-sizing: border-box; }
    html { font-size: 16px; }
    body { font-family: var(--font-stack); background-color: var(--bg-color); margin: 0; padding: 1rem; color: var(--text-primary); line-height: 1.6; }
    .container { width: 100%; max-width: 800px; margin: 0 auto; }
    .main-header { text-align: center; margin-bottom: 2rem; }
    .main-header h1 { font-size: 1.75rem; font-weight: 600; margin: 0 0 0.25rem 0; }
    .main-header p { font-size: 1rem; color: var(--text-secondary); margin: 0; }
    .card { background-color: var(--card-bg-color); border-radius: var(--border-radius-m); box-shadow: var(--shadow-light); margin-bottom: 1.5rem; overflow: hidden; }
    .card-header { padding: 0.75rem 1.5rem; background-color: #f9f9f9; border-bottom: 1px solid var(--border-color); font-weight: 600; font-size: 1.1rem; }
    .card-body { padding: 1.5rem; }
    table { border-collapse: collapse; width: 100%; }
    th, td { padding: 0.75rem 0; text-align: left; border-bottom: 1px solid var(--border-color); vertical-align: middle; }
    table tr:last-child > td { border-bottom: none; }
    th { color: var(--text-secondary); font-weight: 500; font-size: 0.9rem; padding-right: 1rem; white-space: nowrap; }
    input[type="text"], input[type="number"], input[type="date"], select { width: 100%; padding: 0.6rem 0.75rem; border: 1px solid var(--border-color); border-radius: var(--border-radius-s); font-size: 1rem; font-family: var(--font-stack); background-color: #fff; }
    input[readonly] { background-color: var(--input-bg); cursor: default; font-weight: 600; border-style: dashed; }
    button { background-color: var(--brand-blue); color: white; padding: 0.6rem 1.25rem; border: none; cursor: pointer; font-size: 0.95rem; font-weight: 500; border-radius: var(--border-radius-s); transition: background-color 0.2s; }
    button:disabled { background-color: #ccc; cursor: not-allowed; }
    .print-btn { background-color: var(--brand-green); }
    .action-buttons { display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem; }
    
    /* --- !! नवीन आणि व्यावसायिक प्रिंट स्टाईल्स !! --- */
    #printSection { display: none; }
    @media print {
      body { background: #fff; margin: 0; font-family: Arial, sans-serif; font-size: 10pt; color: #333; }
      .container { max-width: 100%; width: 18cm; margin: auto; padding: 0; }
      #recoveryForm, .action-buttons, #status-message, .main-header, #timeRestrictionMessage { display: none; }
      #printSection { display: block !important; }

      .print-header { text-align: center; margin-bottom: 1.5cm; }
      .print-header h1 { font-size: 18pt; margin: 0; color: #000; }
      .print-header p { font-size: 11pt; margin-top: 5px; color: #666; }

      .print-fieldset { border: 1px solid #aaa; padding: 10px 15px 15px 15px; margin-bottom: 0.75cm; }
      .print-fieldset legend { font-weight: bold; font-size: 11pt; padding: 0 5px; color: #000; }
      
      .print-table { width: 100%; border-collapse: collapse; }
      .print-table td { padding: 5px 0; vertical-align: middle; font-size: 10pt; }
      .print-table td:first-child { width: 50%; }
      
      .print-value {
        border: 1px solid #ccc;
        padding: 4px 8px;
        min-height: 28px;
        text-align: right;
      }
      .print-value.text { text-align: left; }
      .print-value.bold { font-weight: bold; }

      #print-loan-details { margin-top: 10px; }
      #print-loan-details table { width: 100%; font-size: 9pt; border-collapse: collapse; }
      #print-loan-details th, #print-loan-details td { border: 1px solid #ccc; padding: 4px; text-align: left; }
      #print-loan-details th { background-color: #f2f2f2; font-weight: bold; }
      #print-loan-details td:nth-child(2) { text-align: right; }
      #print-loan-details td:nth-child(3) { width: 10%; }
    }
  </style>
</head>
<body>
  <main class="container">
    <header class="main-header">
      <h1>अनिक फायनान्सीयल सर्वीसेस</h1>
      <p>दैनंदिन रिकवरी रेकॉर्ड तपशील</p>
    </header>

    <!-- !! नवीन जोडलेला विभाग: वेळेनुसार सूचना !! -->
    <div id="timeRestrictionMessage" style="display: none; text-align: center; background-color: var(--card-bg-color); padding: 2rem; border-radius: var(--border-radius-m); box-shadow: var(--shadow-light);">
      <h2 style="color: var(--brand-red);">फॉर्म सध्या बंद आहे</h2>
      <p style="color: var(--text-secondary); font-size: 1.1rem;">ही सुविधा फक्त सकाळी ६ ते संध्याकाळी ५ या वेळेत उपलब्ध असते.</p>
      <p>कृपया योग्य वेळेत पुन्हा प्रयत्न करा.</p>
    </div>
    
    <form id="recoveryForm" onsubmit="submitReport(event)">
      <!-- तुमचा फॉर्म जसा आहे तसाच... -->
      <section class="card"><div class="card-body"><table><tr><th>युनिट</th><td> <select id="unitName" onchange="populateStaffNames()" required disabled><option value="">युनिट लोड होत आहे...</option></select></td></tr><tr><th>स्टाफचे नांव</th><td> <select id="staffName" onchange="fetchOpeningBalance()" required disabled><option value="">आधी युनिट निवडा</option></select></td></tr><tr><th>दिनांक</th><td><input type="date" id="reportDate" required></td></tr></table></div></section>
      <section class="card"><header class="card-header">एकूण वसुली तपशील</header><div class="card-body"><table><tr><td>आजची एकूण ऑनलाइन रिकवरी (A)</td><td><input type="number" id="onlineRecovery" placeholder="0.00" step="0.01" /></td></tr><tr><td>आजची एकूण ऑफलाईन रिकवरी (B)</td><td><input type="number" id="offlineRecoveryTotal" readonly placeholder="0.00" /></td></tr><tr><td colspan="2"><table id="loanTable"><thead><tr><th>कर्ज क्र.</th><th>रक्कम (₹)</th><th>कृती</th></tr></thead><tbody></tbody></table><div style="text-align:right; padding-top:10px;"><button type="button" onclick="addLoanRow()">+ नवीन कर्ज जोडा</button></div></td></tr><tr><td>एकूण रिकवरी (C = A+B)</td><td><input type="number" id="totalRecovery" readonly placeholder="0.00" /></td></tr><tr><td>प्रारंभीची शिल्लक (D)</td><td><input type="number" id="openingAmount" placeholder="0.00" readonly /></td></tr><tr><td>एकूण रक्कम (E = C+D)</td><td><input type="number" id="totalAmount" readonly placeholder="0.00" /></td></tr></table></div></section>
      <section class="card"><header class="card-header">वरील रक्कमेची फोड</header><div class="card-body"><table><tr><td>स्टेट बॅंकेत भरणा (A)</td><td><input type="number" id="sbiAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>महा ग्रामीणमध्ये भरणा (B)</td><td><input type="number" id="mgbAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>फोनपे QR (C)</td><td><input type="number" id="phonePayAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>अन्य बॅंक (D)</td><td><input type="number" id="otherBankAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>वरीष्ठांकडे जमा (E)</td><td><input type="number" id="cashsr" placeholder="0.00" step="0.01"/></td></tr><tr><td>ऑफिस मध्ये जमा (F)</td><td><input type="number" id="officeAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>हातावर शिल्लक (G)</td><td><input type="number" id="cashInHandAmount" placeholder="0.00" step="0.01"/></td></tr><tr><td>एकूण फोड (A ते G)</td><td><input type="number" id="totalBreakdown" readonly placeholder="0.00" /></td></tr><tr><td>तफावत (E - एकूण फोड)</td><td><input type="number" id="difference" readonly placeholder="0.00" /></td></tr></table></div></section>
      
      <div class="action-buttons">
        <button type="submit" id="submitBtn">रिपोर्ट जतन करा</button>
        <button type="button" id="printBtn" class="print-btn" onclick="window.print()" disabled>रिपोर्ट प्रिंट करा</button>
      </div>
      <div id="status-message" style="text-align:center; margin-top:1rem; font-weight:bold;"></div>
    </form>

    <!-- !! नवीन आणि व्यावसायिक प्रिंट सेक्शन !! -->
    <div id="printSection">
      <div class="print-header">
        <h1>अनिक फायनान्सीयल सर्वीसेस</h1>
        <p>दैनंदिन रिकवरी रेकॉर्ड तपशील</p>
      </div>

      <table class="print-table" style="margin-bottom: 0.75cm; border: 1px solid #aaa; padding: 10px 15px;">
        <tr><td>स्टाफचे नांव</td><td><div class="print-value text" id="print-staffName"></div></td></tr>
        <tr><td>दिनांक</td><td><div class="print-value text" id="print-date"></div></td></tr>
      </table>

      <fieldset class="print-fieldset">
        <legend>एकूण वसुली तपशील (Recovery Details)</legend>
        <table class="print-table">
          <tr><td>आजची एकूण ऑनलाइन रिकवरी (A)</td><td><div class="print-value" id="print-onlineRecovery"></div></td></tr>
          <tr><td>आजची एकूण ऑफलाईन रिकवरी (B)</td><td><div class="print-value" id="print-offlineRecoveryTotal"></div></td></tr>
        </table>
        <div id="print-loan-details"></div>
        <table class="print-table" style="margin-top: 10px;">
          <tr><td>एकूण रिकवरी (C = A+B)</td><td><div class="print-value bold" id="print-totalRecovery"></div></td></tr>
          <tr><td>प्रारंभीची शिल्लक रक्कम (D)</td><td><div class="print-value" id="print-openingAmount"></div></td></tr>
          <tr><td>एकूण रक्कम (E = C+D)</td><td><div class="print-value bold" id="print-totalAmount"></div></td></tr>
        </table>
      </fieldset>

      <fieldset class="print-fieldset">
        <legend>वरील रक्कमेची फोड (Cash Breakdown)</legend>
        <table class="print-table">
          <tr><td>स्टेट बँकेत भरणा (A)</td><td><div class="print-value" id="print-sbiAmount"></div></td></tr>
          <tr><td>महा ग्रामीणमध्ये भरणा (B)</td><td><div class="print-value" id="print-mgbAmount"></div></td></tr>
          <tr><td>फोनपे QR (C)</td><td><div class="print-value" id="print-phonePayAmount"></div></td></tr>
          <tr><td>अन्य बँक (D)</td><td><div class="print-value" id="print-otherBankAmount"></div></td></tr>
          <tr><td>वरीष्ठांकडे जमा (E)</td><td><div class="print-value" id="print-cashsr"></div></td></tr>
          <tr><td>ऑफिस मध्ये जमा (F)</td><td><div class="print-value" id="print-officeAmount"></div></td></tr>
          <tr><td>हातावर शिल्लक (G)</td><td><div class="print-value" id="print-cashInHandAmount"></div></td></tr>
          <tr><td><strong>एकूण फोड (A ते G)</strong></td><td><div class="print-value bold" id="print-totalBreakdown"></div></td></tr>
          <tr><td><strong>तफावत (E - एकूण फोड)</strong></td><td><div class="print-value bold" id="print-difference"></div></td></tr>
        </table>
      </fieldset>
    </div>
  </main>
  
  <script>
    // --- तुमचा मूळ स्क्रिप्ट कोड जसा आहे तसाच ---
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbynDdxBV_2MdsTNMdFJvWGC9sXZXUn0QtgCh_RbN_jD1Sb4QoX58v1w7IGRRz8Bots/exec";
    const API_KEY = "AIzaSyAQQZz2KDKZtJw7YZBRAvHaO-Uy68Ps57s";
    const SHEET_ID = "1FJQ7fd__PRnHTDjfvOPWSwGo2_w-S-4sx1mcpRTVskk";
    const STAFF_SHEET_NAME = "StaffList";
    const REPORTS_SHEET_NAME = "Recovery Data";
    let staffData = {};
    let allReports = [];

    async function submitReport(event) {
        event.preventDefault();
        const statusDiv = document.getElementById('status-message');
        const submitBtn = document.getElementById('submitBtn');
        const printBtn = document.getElementById('printBtn');
        if (getFloatValue("difference").toFixed(2) !== '0.00' && getFloatValue("difference").toFixed(2) !== '-0.00') { alert("तफावत (Difference) 0 नाही."); return; }
        const staffName = document.getElementById('staffName').value;
        if (!staffName) { alert("कृपया स्टाफचे नाव निवडा."); return; }
        const reportDateStr = document.getElementById('reportDate').value;
        const dateToCompare = new Date(reportDateStr).toLocaleDateString('en-CA');
        const isDuplicate = allReports.some(report => {
            if (!report[0] || !report[2]) return false;
            const dateParts = report[0].split('/');
            const sheetDate = dateParts.length === 3 ? new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]) : new Date(report[0]);
            const sheetDateStr = sheetDate.toLocaleDateString('en-CA');
            return sheetDateStr === dateToCompare && report[2] === staffName;
        });
        if (isDuplicate) { alert("या तारखेचा रिपोर्ट तुम्ही आधीच सबमिट केला आहे."); return; }
        submitBtn.disabled = true; printBtn.disabled = true; submitBtn.textContent = "जतन होत आहे..."; statusDiv.textContent = "";
        const reportData = {
            reportDate: reportDateStr, staffName, unitName: document.getElementById('unitName').value,
            openingAmount: getFloatValue('openingAmount'), onlineRecovery: getFloatValue('onlineRecovery'),
            offlineRecoveryTotal: getFloatValue('offlineRecoveryTotal'), totalRecovery: getFloatValue('totalRecovery'),
            totalAmount: getFloatValue('totalAmount'), sbiAmount: getFloatValue('sbiAmount'),
            mgbAmount: getFloatValue('mgbAmount'), phonePayAmount: getFloatValue('phonePayAmount'),
            otherBankAmount: getFloatValue('otherBankAmount'), cashsr: getFloatValue('cashsr'),
            officeAmount: getFloatValue('officeAmount'), cashInHandAmount: getFloatValue('cashInHandAmount')
        };
        try {
            await fetch(WEB_APP_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(reportData) });
            statusDiv.textContent = "रिपोर्ट यशस्वीरित्या जतन झाला. तुम्ही आता प्रिंट घेऊ शकता."; statusDiv.style.color = 'var(--brand-green)';
            populatePrintSection(reportData);
            printBtn.disabled = false; submitBtn.textContent = "नवीन रिपोर्ट भरा";
            loadInitialData();
        } catch (error) {
            statusDiv.textContent = "त्रुटी: रिपोर्ट जतन झाला नाही."; statusDiv.style.color = 'var(--brand-red)';
            console.error(error); submitBtn.disabled = false; submitBtn.textContent = "पुन्हा प्रयत्न करा";
        }
    }
    
    function populatePrintSection(data) {
        const setVal = (id, value, isText = false) => { const el = document.getElementById(id); el.textContent = value; if(isText) el.classList.add('text'); else el.classList.remove('text'); };
        const f = (num) => (typeof num === 'number' ? num.toFixed(2) : '0.00');
        
        setVal('print-staffName', data.staffName, true);
        setVal('print-date', new Date(data.reportDate).toLocaleDateString('en-GB'), true);
        
        setVal('print-onlineRecovery', f(data.onlineRecovery)); setVal('print-offlineRecoveryTotal', f(data.offlineRecoveryTotal));
        setVal('print-totalRecovery', f(data.totalRecovery)); setVal('print-openingAmount', f(data.openingAmount));
        setVal('print-totalAmount', f(data.totalAmount));
        
        setVal('print-sbiAmount', f(data.sbiAmount)); setVal('print-mgbAmount', f(data.mgbAmount));
        setVal('print-phonePayAmount', f(data.phonePayAmount)); setVal('print-otherBankAmount', f(data.otherBankAmount));
        setVal('print-cashsr', f(data.cashsr)); setVal('print-officeAmount', f(data.officeAmount));
        setVal('print-cashInHandAmount', f(data.cashInHandAmount));

        const totalBreakdown = [data.sbiAmount, data.mgbAmount, data.phonePayAmount, data.otherBankAmount, data.cashsr, data.officeAmount, data.cashInHandAmount].reduce((a, b) => a + b, 0);
        setVal('print-totalBreakdown', f(totalBreakdown));
        setVal('print-difference', f(data.totalAmount - totalBreakdown));

        const loanRows = document.querySelectorAll('#loanTable tbody tr');
        let loanTableHTML = `<table><thead><tr><th>कर्ज क्रमांक</th><th>रक्कम (₹)</th><th>कृती</th></tr></thead><tbody>`;
        let hasOfflineData = false;
        loanRows.forEach(row => {
            const loanNo = row.cells[0].querySelector('input').value;
            const amount = parseFloat(row.cells[1].querySelector('input').value || 0);
            if (loanNo || amount > 0) {
                 loanTableHTML += `<tr><td>${loanNo || '-'}</td><td>${f(amount)}</td><td></td></tr>`;
                 hasOfflineData = true;
            }
        });
        document.getElementById('print-loan-details').innerHTML = hasOfflineData ? loanTableHTML + '</tbody></table>' : '<p style="text-align:center; font-style:italic; font-size:9pt; color:#888;">ऑफलाईन रिकवरी नाही.</p>';
    }

    async function loadInitialData() {
        const staffUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${STAFF_SHEET_NAME}?key=${API_KEY}`;
        const reportsUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/'${REPORTS_SHEET_NAME}'!B:P?key=${API_KEY}`;
        try {
            const [staffResponse, reportsResponse] = await Promise.all([ fetch(staffUrl), fetch(reportsUrl) ]);
            if (!staffResponse.ok || !reportsResponse.ok) throw new Error(`API call failed.`);
            const staffJson = await staffResponse.json(); const reportsJson = await reportsResponse.json();
            const staffList = staffJson.values ? staffJson.values.slice(1) : [];
            allReports = reportsJson.values ? reportsJson.values : [];
            staffData = {};
            staffList.forEach(row => { const unit = row[0]; const name = row[1]; if (!staffData[unit]) staffData[unit] = []; staffData[unit].push(name); });
            const unitSelect = document.getElementById('unitName'); unitSelect.innerHTML = '<option value="">युनिट निवडा</option>';
            Object.keys(staffData).sort().forEach(unit => { unitSelect.innerHTML += `<option value="${unit}">${unit}</option>`; });
            unitSelect.disabled = false;
        } catch (error) { alert("डेटा लोड करण्यात अयशस्वी!"); console.error(error); }
    }
    function fetchOpeningBalance() { const staffName = document.getElementById('staffName').value; const openingAmountInput = document.getElementById('openingAmount'); openingAmountInput.value = "0.00"; if (staffName && allReports.length > 0) { for (let i = allReports.length - 1; i >= 0; i--) { const reportStaffName = allReports[i][2]; const cashInHand = allReports[i][14]; if (reportStaffName === staffName) { openingAmountInput.value = parseFloat(cashInHand || 0).toFixed(2); break; } } } calculateAllTotals(); }
    function populateStaffNames() { const selectedUnit = document.getElementById('unitName').value; const staffSelect = document.getElementById('staffName'); staffSelect.innerHTML = '<option value="">स्टाफ निवडा</option>'; staffSelect.disabled = true; if (selectedUnit && staffData[selectedUnit]) { staffData[selectedUnit].sort().forEach(name => { staffSelect.innerHTML += `<option value="${name}">${name}</option>`; }); staffSelect.disabled = false; } fetchOpeningBalance(); }
    
    function getFloatValue(id) { return parseFloat(document.getElementById(id).value) || 0; }
    function addLoanRow() { const tbody = document.getElementById('loanTable').querySelector('tbody'); tbody.insertAdjacentHTML('beforeend', `<tr><td><input type="text"></td><td><input type="number" step="0.01"></td><td><button type="button" onclick="this.parentElement.parentElement.remove()">काढा</button></td></tr>`); }
    function calculateAllTotals() { const offlineRecovery = Array.from(document.querySelectorAll('#loanTable tbody input[type=number]')).reduce((sum, el) => sum + (parseFloat(el.value) || 0), 0); document.getElementById('offlineRecoveryTotal').value = offlineRecovery.toFixed(2); const onlineRecovery = getFloatValue("onlineRecovery"); const openingAmount = getFloatValue("openingAmount"); const totalRecovery = onlineRecovery + offlineRecovery; const totalAmount = openingAmount + totalRecovery; document.getElementById('totalRecovery').value = totalRecovery.toFixed(2); document.getElementById('totalAmount').value = totalAmount.toFixed(2); const breakdownTotal = ['sbiAmount', 'mgbAmount', 'phonePayAmount', 'otherBankAmount', 'cashsr', 'officeAmount', 'cashInHandAmount'].reduce((sum, id) => sum + getFloatValue(id), 0); document.getElementById('totalBreakdown').value = breakdownTotal.toFixed(2); document.getElementById('difference').value = (totalAmount - breakdownTotal).toFixed(2); }

    // --- !! नवीन जोडलेला कोड: वेळेनुसार फॉर्म चालू/बंद करण्यासाठी !! ---
    
    // -- इथे तुम्ही वेळ बदलू शकता --
    // २४-तासांच्या फॉरमॅटमध्ये वेळ टाका. उदा. सकाळी ६ साठी 6, संध्याकाळी ५ साठी 17
    const FORM_START_HOUR = 6;  // सकाळी ६ वाजता फॉर्म चालू होईल
    const FORM_END_HOUR = 17;   // संध्याकाळी ५ वाजता फॉर्म बंद होईल

    function checkTimeAndToggleForm() {
      const formElement = document.getElementById('recoveryForm');
      const messageElement = document.getElementById('timeRestrictionMessage');
      const headerElement = document.querySelector('.main-header');

      const now = new Date();
      const currentHour = now.getHours(); // ० ते २३ मधील चालू तास मिळवतो

      // अट: जर चालू तास सकाळी ६ पेक्षा कमी असेल (म्हणजे रात्री १२ ते सकाळी ५:५९) 
      // किंवा चालू तास संध्याकाळी ५ किंवा त्यानंतरचा असेल (म्हणजे संध्याकाळी ५ ते रात्री ११:५९)
      if (currentHour < FORM_START_HOUR || currentHour >= FORM_END_HOUR) {
        // फॉर्म बंद करण्याची वेळ
        formElement.style.display = 'none';
        messageElement.style.display = 'block';
        headerElement.style.display = 'none'; // हेडर पण लपवा
      } else {
        // फॉर्म चालू ठेवण्याची वेळ
        formElement.style.display = 'block';
        messageElement.style.display = 'none';
        headerElement.style.display = 'block'; // हेडर दाखवा
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // पेज लोड झाल्यावर सर्वात आधी वेळ तपासा
      checkTimeAndToggleForm(); 
      
      // तुमचा मूळ कोड जसा आहे तसाच...
      loadInitialData(); 
      document.getElementById('reportDate').value = new Date().toISOString().split('T')[0]; 
      addLoanRow(); 
      document.getElementById('recoveryForm').addEventListener('input', calculateAllTotals); 
    });
  </script>
</body>

</html>


